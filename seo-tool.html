<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#1e1b4b">
    <meta name="robots" content="noindex, nofollow">
    <title>SEO è¯Šæ–­å¤§å¸ˆ | åœ¨çº¿ SEO åˆ†æå·¥å…·</title>
    <meta name="description" content="å…è´¹åœ¨çº¿SEOåˆ†æå·¥å…·ï¼Œä¸€é”®æ£€æµ‹ç½‘ç«™SEOé—®é¢˜ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€æè¿°ã€H1æ ‡ç­¾ã€Open Graphã€å†…é“¾ç­‰12é¡¹å…³é”®æŒ‡æ ‡ã€‚">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* æ·±è‰²ç§‘æŠ€é£æ ¼ */
        body {
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 50%, #0a0a1a 100%);
            min-height: 100vh;
        }

        /* æ¸å˜èƒŒæ™¯è£…é¥° */
        .bg-glow {
            position: fixed;
            border-radius: 50%;
            filter: blur(100px);
            opacity: 0.3;
            pointer-events: none;
        }

        .bg-glow-1 {
            width: 600px;
            height: 600px;
            background: #8b5cf6;
            top: -200px;
            right: -100px;
        }

        .bg-glow-2 {
            width: 500px;
            height: 500px;
            background: #3b82f6;
            bottom: -150px;
            left: -100px;
        }

        /* å¡ç‰‡æ ·å¼ */
        .card {
            background: rgba(30, 27, 75, 0.6);
            border: 1px solid rgba(139, 92, 246, 0.2);
            backdrop-filter: blur(10px);
        }

        .card:hover {
            border-color: rgba(139, 92, 246, 0.4);
        }

        /* è¾“å…¥æ¡†æ ·å¼ */
        .input-glow:focus {
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
        }

        /* æŒ‰é’®åŠ¨ç”» */
        .btn-primary {
            background: linear-gradient(135deg, #8b5cf6, #6366f1);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        /* è¯„åˆ†åœ†ç¯ */
        .score-ring {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(#22c55e var(--score-percent, 0%),
                    rgba(255, 255, 255, 0.1) var(--score-percent, 0%));
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .score-ring-inner {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: #1e1b4b;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* çŠ¶æ€æ ‡ç­¾ */
        .status-pass {
            color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
        }

        .status-fail {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .status-warn {
            color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(139, 92, 246, 0.3);
            border-top-color: #8b5cf6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* ç»“æœé¡¹åŠ¨ç”» */
        .result-item {
            animation: fadeInUp 0.3s ease forwards;
            opacity: 0;
            transform: translateY(10px);
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ä»£ç å—æ ·å¼ */
        .code-block {
            background: #0a0a1a;
            border: 1px solid rgba(139, 92, 246, 0.3);
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 13px;
            overflow-x: auto;
        }
    </style>
</head>

<body class="text-white">
    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="bg-glow bg-glow-1"></div>
    <div class="bg-glow bg-glow-2"></div>

    <div class="relative z-10 container mx-auto px-4 py-8" style="max-width: 1000px;">
        <!-- å¤´éƒ¨ -->
        <header class="text-center mb-10">
            <div class="flex items-center justify-between mb-6">
                <a href="index.html" class="text-purple-400 hover:text-purple-300 transition-colors">
                    â† è¿”å›å¯¼èˆªç«™
                </a>
                <span class="text-slate-500 text-sm">v1.0</span>
            </div>
            <h1
                class="text-4xl md:text-5xl font-bold mb-3 bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent">
                ğŸ” SEO è¯Šæ–­å¤§å¸ˆ
            </h1>
            <p class="text-slate-400 max-w-xl mx-auto">
                è¾“å…¥ä»»æ„ç½‘å€ï¼Œä¸€é”®è·å–å…¨é¢çš„ SEO è¯Šæ–­æŠ¥å‘Šï¼ŒåŒ…å« 12 é¡¹å…³é”®æŒ‡æ ‡åˆ†æå’Œä¼˜åŒ–å»ºè®®
            </p>
        </header>

        <!-- è¾“å…¥åŒºåŸŸ -->
        <section class="card rounded-2xl p-6 mb-6">
            <div class="flex flex-col md:flex-row gap-4">
                <div class="flex-1">
                    <label class="block text-sm text-slate-400 mb-2">ç›®æ ‡ç½‘å€ *</label>
                    <input type="url" id="urlInput" placeholder="https://example.com" required
                        class="input-glow w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 transition-colors">
                </div>
                <div class="md:w-64">
                    <label class="block text-sm text-slate-400 mb-2">å…³é”®è¯ (å¯é€‰)</label>
                    <input type="text" id="keywordInput" placeholder="SEO, ä¼˜åŒ–, å·¥å…·..."
                        class="input-glow w-full px-4 py-3 bg-slate-900/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 transition-colors">
                </div>
            </div>
            <div class="mt-4 flex flex-col sm:flex-row gap-3">
                <button onclick="runAudit()" id="auditBtn"
                    class="btn-primary flex-1 px-6 py-3 rounded-xl font-semibold text-white flex items-center justify-center gap-2">
                    <span id="btnIcon">ğŸš€</span>
                    <span id="btnText">å¼€å§‹åˆ†æ</span>
                </button>
                <button onclick="clearResults()"
                    class="px-6 py-3 bg-slate-800 hover:bg-slate-700 rounded-xl font-medium text-slate-300 transition-colors">
                    ğŸ—‘ï¸ æ¸…é™¤ç»“æœ
                </button>
            </div>
        </section>

        <!-- åŠ è½½çŠ¶æ€ -->
        <div id="loadingState" class="hidden card rounded-2xl p-10 mb-6 text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-slate-400">æ­£åœ¨åˆ†æç½‘é¡µï¼Œè¯·ç¨å€™...</p>
            <p class="text-slate-500 text-sm mt-2" id="loadingTip">æ­£åœ¨è·å–é¡µé¢å†…å®¹</p>
        </div>

        <!-- ç»“æœåŒºåŸŸ -->
        <div id="resultArea" class="hidden">
            <!-- ç»¼åˆè¯„åˆ† -->
            <section class="card rounded-2xl p-6 mb-6">
                <div class="flex flex-col md:flex-row items-center gap-6">
                    <div class="score-ring" id="scoreRing">
                        <div class="score-ring-inner">
                            <span class="text-4xl font-bold" id="scoreValue">0</span>
                            <span class="text-slate-400 text-sm">/ 100</span>
                        </div>
                    </div>
                    <div class="flex-1 text-center md:text-left">
                        <h2 class="text-2xl font-bold mb-2" id="scoreLabel">æ­£åœ¨è®¡ç®—...</h2>
                        <p class="text-slate-400" id="scoreDesc">æ­£åœ¨åˆ†ææ‚¨çš„ç½‘é¡µ SEO çŠ¶å†µ</p>
                        <div class="flex flex-wrap gap-2 mt-4 justify-center md:justify-start" id="quickStats">
                            <!-- å¿«é€Ÿç»Ÿè®¡å°†åŠ¨æ€æ’å…¥ -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- æ£€æµ‹é¡¹ç›® -->
            <section class="card rounded-2xl p-6 mb-6">
                <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                    ğŸ“‹ è¯¦ç»†æ£€æµ‹æŠ¥å‘Š
                </h3>
                <div id="resultList" class="space-y-3">
                    <!-- ç»“æœé¡¹å°†åŠ¨æ€æ’å…¥ -->
                </div>
            </section>

            <!-- ä¼˜åŒ–å»ºè®®ä»£ç  -->
            <section id="suggestionSection" class="card rounded-2xl p-6 mb-6 hidden">
                <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                    ğŸ’¡ ä¼˜åŒ–å»ºè®®ä»£ç 
                </h3>
                <p class="text-slate-400 text-sm mb-4">ä»¥ä¸‹æ˜¯æ ¹æ®æ£€æµ‹ç»“æœç”Ÿæˆçš„ä¼˜åŒ–ä»£ç ï¼Œå¯ç›´æ¥å¤åˆ¶åˆ°ç½‘é¡µ &lt;head&gt; ä¸­ï¼š</p>
                <div class="code-block rounded-xl p-4 mb-4">
                    <pre id="suggestionCode" class="text-green-400 whitespace-pre-wrap"></pre>
                </div>
                <button onclick="copyCode()"
                    class="px-4 py-2 bg-purple-600 hover:bg-purple-500 rounded-lg text-sm font-medium transition-colors">
                    ğŸ“‹ å¤åˆ¶ä»£ç 
                </button>
            </section>
        </div>

        <!-- ä½¿ç”¨è¯´æ˜ -->
        <section class="card rounded-2xl p-6 mb-6">
            <h3 class="text-lg font-bold mb-3">ğŸ“– ä½¿ç”¨è¯´æ˜</h3>
            <div class="grid md:grid-cols-2 gap-4 text-sm text-slate-400">
                <div>
                    <h4 class="text-white font-medium mb-2">æ£€æµ‹é¡¹ç›®</h4>
                    <ul class="space-y-1">
                        <li>âœ“ æ ‡é¢˜ (Title) é•¿åº¦æ£€æµ‹</li>
                        <li>âœ“ å…ƒæè¿° (Meta Description)</li>
                        <li>âœ“ H1 æ ‡ç­¾æ£€æµ‹</li>
                        <li>âœ“ Canonical é“¾æ¥</li>
                        <li>âœ“ Open Graph ç¤¾äº¤æ ‡ç­¾</li>
                        <li>âœ“ å†…å®¹å­—æ•°ç»Ÿè®¡</li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-white font-medium mb-2">é«˜çº§åˆ†æ</h4>
                    <ul class="space-y-1">
                        <li>âœ“ å†…é“¾æ£€æµ‹</li>
                        <li>âœ“ å›¾ç‰‡æ£€æµ‹</li>
                        <li>âœ“ å…³é”®è¯åœ¨æ ‡é¢˜ä¸­å‡ºç°</li>
                        <li>âœ“ å…³é”®è¯åœ¨ H1 ä¸­å‡ºç°</li>
                        <li>âœ“ å…³é”®è¯åœ¨æè¿°ä¸­å‡ºç°</li>
                        <li>âœ“ å…³é”®è¯å¯†åº¦åˆ†æ</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- åº•éƒ¨ -->
        <footer class="text-center text-slate-500 text-sm py-6">
            <p>åŸºäº <a href="https://github.com/ngerank/seo-audit-tool" target="_blank"
                    class="text-purple-400 hover:text-purple-300">ngerank/seo-audit-tool</a> å¼€æºé¡¹ç›®</p>
            <p class="mt-1">æ”¯æŒå¤š CORS ä»£ç†è‡ªåŠ¨åˆ‡æ¢ï¼ˆAllOrigins / CorsProxy.io / CorsAnywhereï¼‰</p>
        </footer>
    </div>

    <script>
        // SEO åˆ†æå·¥å…·æ ¸å¿ƒé€»è¾‘

        // å¤šä¸ª CORS ä»£ç†æºï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼Œè‡ªåŠ¨æ•…éšœè½¬ç§»ï¼‰
        const CORS_PROXIES = [
            {
                name: 'AllOrigins',
                url: 'https://api.allorigins.win/get?url=',
                parseResponse: async (response) => {
                    const data = await response.json();
                    return data.contents;
                }
            },
            {
                name: 'CorsProxy.io',
                url: 'https://corsproxy.io/?',
                parseResponse: async (response) => {
                    return await response.text();
                }
            },
            {
                name: 'CorsAnywhere (å¤‡ç”¨)',
                url: 'https://cors-anywhere.herokuapp.com/',
                parseResponse: async (response) => {
                    return await response.text();
                }
            }
        ];

        let currentProxyIndex = 0;

        // é€šè¿‡ä»£ç†è·å–é¡µé¢å†…å®¹ï¼ˆå¸¦è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼‰
        async function fetchWithProxy(url, proxyIndex = 0) {
            if (proxyIndex >= CORS_PROXIES.length) {
                throw new Error('æ‰€æœ‰ä»£ç†å‡ä¸å¯ç”¨');
            }

            const proxy = CORS_PROXIES[proxyIndex];
            updateLoadingTip(`æ­£åœ¨é€šè¿‡ ${proxy.name} è·å–é¡µé¢... (${proxyIndex + 1}/${CORS_PROXIES.length})`);

            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 20000); // 20ç§’è¶…æ—¶ï¼ˆå¢åŠ äº†æ—¶é—´ï¼‰

                console.log(`å°è¯•ä»£ç† ${proxy.name}: ${proxy.url}${url.substring(0, 50)}...`);

                const response = await fetch(proxy.url + encodeURIComponent(url), {
                    signal: controller.signal,
                    headers: {
                        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
                    }
                });

                clearTimeout(timeoutId);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const html = await proxy.parseResponse(response);

                if (!html) {
                    throw new Error('è¿”å›å†…å®¹ä¸ºç©º');
                }

                // æ£€æŸ¥æ˜¯å¦æ˜¯æœ‰æ•ˆçš„ HTML
                if (html.length < 50 || (!html.includes('<') && !html.includes('html'))) {
                    throw new Error('è¿”å›å†…å®¹ä¸æ˜¯æœ‰æ•ˆçš„ HTML');
                }

                currentProxyIndex = proxyIndex; // è®°ä½æˆåŠŸçš„ä»£ç†
                console.log(`âœ“ ${proxy.name} æˆåŠŸè·å– ${html.length} å­—ç¬¦`);
                return html;

            } catch (error) {
                const errorType = error.name === 'AbortError' ? 'è¶…æ—¶' : error.message;
                console.warn(`âœ— ${proxy.name} å¤±è´¥: ${errorType}`);

                // å°è¯•ä¸‹ä¸€ä¸ªä»£ç†
                if (proxyIndex < CORS_PROXIES.length - 1) {
                    updateLoadingTip(`${proxy.name} ${errorType}ï¼Œæ­£åœ¨åˆ‡æ¢å¤‡ç”¨ä»£ç†...`);
                    await new Promise(r => setTimeout(r, 300)); // çŸ­æš‚å»¶è¿Ÿ
                    return fetchWithProxy(url, proxyIndex + 1);
                }

                // æ‰€æœ‰ä»£ç†éƒ½å¤±è´¥äº†
                throw new Error(`æ‰€æœ‰ä»£ç†å‡å¤±è´¥ (æœ€åé”™è¯¯: ${errorType})`);
            }
        }

        // è¿è¡Œ SEO åˆ†æ
        async function runAudit() {
            let url = document.getElementById('urlInput').value.trim();
            const keyword = document.getElementById('keywordInput').value.trim().toLowerCase();

            if (!url) {
                showToast('è¯·è¾“å…¥ç½‘å€', 'error');
                return;
            }

            // è‡ªåŠ¨æ·»åŠ åè®®
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
                document.getElementById('urlInput').value = url;
            }

            // éªŒè¯ URL æ ¼å¼
            let parsedUrl;
            try {
                parsedUrl = new URL(url);
            } catch {
                showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„ç½‘å€', 'error');
                return;
            }

            // è§„èŒƒåŒ– URLï¼ˆç¡®ä¿æ ¼å¼æ­£ç¡®ï¼‰
            const normalizedUrl = parsedUrl.href;

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            setLoading(true);

            try {
                // é€šè¿‡ CORS ä»£ç†è·å–é¡µé¢å†…å®¹ï¼ˆå¸¦è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼‰
                const html = await fetchWithProxy(normalizedUrl, 0); // æ€»æ˜¯ä»ç¬¬ä¸€ä¸ªä»£ç†å¼€å§‹

                updateLoadingTip('æ­£åœ¨è§£æ HTML...');

                // è§£æ HTML
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');

                updateLoadingTip('æ­£åœ¨åˆ†æ SEO æŒ‡æ ‡...');

                // æ‰§è¡Œå„é¡¹æ£€æµ‹
                const results = await analyzeDocument(doc, normalizedUrl, keyword, html);

                // æ˜¾ç¤ºç»“æœ
                displayResults(results);

            } catch (error) {
                console.error('åˆ†æå¤±è´¥:', error);

                // æä¾›æ›´å‹å¥½çš„é”™è¯¯æç¤º
                let errorMessage = error.message;
                if (error.name === 'AbortError' || errorMessage.includes('abort')) {
                    errorMessage = 'è¯·æ±‚è¶…æ—¶ï¼Œç›®æ ‡ç½‘ç«™å“åº”è¾ƒæ…¢æˆ–æ— æ³•è®¿é—®';
                } else if (errorMessage.includes('Failed to fetch') || errorMessage.includes('NetworkError')) {
                    errorMessage = 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–ç¨åé‡è¯•';
                } else if (errorMessage.includes('æ‰€æœ‰ä»£ç†')) {
                    errorMessage = 'æ‰€æœ‰ä»£ç†å‡è¶…æ—¶ï¼Œç›®æ ‡ç½‘ç«™å¯èƒ½æ— æ³•é€šè¿‡ä»£ç†è®¿é—®';
                }

                showToast('åˆ†æå¤±è´¥: ' + errorMessage, 'error');
                setLoading(false);
            }
        }

        // åˆ†ææ–‡æ¡£
        async function analyzeDocument(doc, url, keyword, html) {
            const results = [];
            let passCount = 0;
            let totalChecks = 0;

            // 1. æ ‡é¢˜æ£€æµ‹
            const title = doc.querySelector('title')?.textContent?.trim() || '';
            const titleLength = title.length;
            totalChecks++;
            if (title && titleLength >= 30 && titleLength <= 60) {
                passCount++;
                results.push({
                    name: 'é¡µé¢æ ‡é¢˜',
                    status: 'pass',
                    message: `æ ‡é¢˜é•¿åº¦ ${titleLength} å­—ç¬¦ï¼ˆæ¨è 30-60ï¼‰`,
                    detail: title,
                    icon: 'ğŸ“'
                });
            } else if (title) {
                results.push({
                    name: 'é¡µé¢æ ‡é¢˜',
                    status: titleLength < 30 ? 'warn' : 'fail',
                    message: `æ ‡é¢˜é•¿åº¦ ${titleLength} å­—ç¬¦ï¼ˆæ¨è 30-60ï¼‰`,
                    detail: title,
                    icon: 'ğŸ“'
                });
            } else {
                results.push({
                    name: 'é¡µé¢æ ‡é¢˜',
                    status: 'fail',
                    message: 'ç¼ºå°‘é¡µé¢æ ‡é¢˜',
                    icon: 'ğŸ“'
                });
            }

            // 2. Meta Description æ£€æµ‹
            const metaDesc = doc.querySelector('meta[name="description"]')?.getAttribute('content')?.trim() || '';
            totalChecks++;
            if (metaDesc && metaDesc.length >= 50 && metaDesc.length <= 160) {
                passCount++;
                results.push({
                    name: 'å…ƒæè¿°',
                    status: 'pass',
                    message: `æè¿°é•¿åº¦ ${metaDesc.length} å­—ç¬¦ï¼ˆæ¨è 50-160ï¼‰`,
                    detail: metaDesc,
                    icon: 'ğŸ“„'
                });
            } else if (metaDesc) {
                results.push({
                    name: 'å…ƒæè¿°',
                    status: 'warn',
                    message: `æè¿°é•¿åº¦ ${metaDesc.length} å­—ç¬¦ï¼ˆæ¨è 50-160ï¼‰`,
                    detail: metaDesc,
                    icon: 'ğŸ“„'
                });
            } else {
                results.push({
                    name: 'å…ƒæè¿°',
                    status: 'fail',
                    message: 'ç¼ºå°‘ meta description',
                    icon: 'ğŸ“„'
                });
            }

            // 3. H1 æ ‡ç­¾æ£€æµ‹
            const h1Tags = doc.querySelectorAll('h1');
            totalChecks++;
            if (h1Tags.length === 1) {
                passCount++;
                results.push({
                    name: 'H1 æ ‡ç­¾',
                    status: 'pass',
                    message: 'å­˜åœ¨å”¯ä¸€çš„ H1 æ ‡ç­¾',
                    detail: h1Tags[0].textContent.trim().substring(0, 100),
                    icon: 'ğŸ·ï¸'
                });
            } else if (h1Tags.length > 1) {
                results.push({
                    name: 'H1 æ ‡ç­¾',
                    status: 'warn',
                    message: `å­˜åœ¨ ${h1Tags.length} ä¸ª H1 æ ‡ç­¾ï¼ˆå»ºè®®åªä¿ç•™ 1 ä¸ªï¼‰`,
                    icon: 'ğŸ·ï¸'
                });
            } else {
                results.push({
                    name: 'H1 æ ‡ç­¾',
                    status: 'fail',
                    message: 'ç¼ºå°‘ H1 æ ‡ç­¾',
                    icon: 'ğŸ·ï¸'
                });
            }

            // 4. Canonical é“¾æ¥æ£€æµ‹
            const canonical = doc.querySelector('link[rel="canonical"]')?.getAttribute('href') || '';
            totalChecks++;
            if (canonical) {
                passCount++;
                results.push({
                    name: 'Canonical é“¾æ¥',
                    status: 'pass',
                    message: 'å­˜åœ¨è§„èŒƒé“¾æ¥',
                    detail: canonical,
                    icon: 'ğŸ”—'
                });
            } else {
                results.push({
                    name: 'Canonical é“¾æ¥',
                    status: 'warn',
                    message: 'ç¼ºå°‘ canonical é“¾æ¥',
                    icon: 'ğŸ”—'
                });
            }

            // 5. Open Graph æ£€æµ‹
            const ogTitle = doc.querySelector('meta[property="og:title"]')?.getAttribute('content') || '';
            const ogDesc = doc.querySelector('meta[property="og:description"]')?.getAttribute('content') || '';
            const ogImage = doc.querySelector('meta[property="og:image"]')?.getAttribute('content') || '';
            totalChecks++;
            const ogCount = [ogTitle, ogDesc, ogImage].filter(Boolean).length;
            if (ogCount >= 3) {
                passCount++;
                results.push({
                    name: 'Open Graph',
                    status: 'pass',
                    message: 'ç¤¾äº¤åˆ†äº«æ ‡ç­¾å®Œæ•´',
                    detail: `og:title, og:description, og:image å‡å·²è®¾ç½®`,
                    icon: 'ğŸ“±'
                });
            } else if (ogCount > 0) {
                results.push({
                    name: 'Open Graph',
                    status: 'warn',
                    message: `ç¤¾äº¤åˆ†äº«æ ‡ç­¾ä¸å®Œæ•´ï¼ˆ${ogCount}/3ï¼‰`,
                    icon: 'ğŸ“±'
                });
            } else {
                results.push({
                    name: 'Open Graph',
                    status: 'fail',
                    message: 'ç¼ºå°‘ Open Graph ç¤¾äº¤æ ‡ç­¾',
                    icon: 'ğŸ“±'
                });
            }

            // 6. å†…å®¹å­—æ•°ç»Ÿè®¡
            const bodyText = doc.body?.textContent || '';
            const wordCount = bodyText.trim().split(/\s+/).filter(w => w.length > 0).length;
            const charCount = bodyText.replace(/\s/g, '').length;
            totalChecks++;
            if (charCount >= 300) {
                passCount++;
                results.push({
                    name: 'å†…å®¹é•¿åº¦',
                    status: 'pass',
                    message: `é¡µé¢åŒ…å«çº¦ ${charCount} ä¸ªå­—ç¬¦`,
                    icon: 'ğŸ“Š'
                });
            } else {
                results.push({
                    name: 'å†…å®¹é•¿åº¦',
                    status: 'warn',
                    message: `å†…å®¹è¾ƒå°‘ï¼Œä»… ${charCount} ä¸ªå­—ç¬¦ï¼ˆå»ºè®® 300+ï¼‰`,
                    icon: 'ğŸ“Š'
                });
            }

            // 7. å†…é“¾æ£€æµ‹
            const internalLinks = doc.querySelectorAll('a[href^="/"], a[href^="./"], a[href^="../"]');
            const domainLinks = doc.querySelectorAll(`a[href*="${new URL(url).hostname}"]`);
            const totalInternalLinks = internalLinks.length + domainLinks.length;
            totalChecks++;
            if (totalInternalLinks >= 3) {
                passCount++;
                results.push({
                    name: 'å†…éƒ¨é“¾æ¥',
                    status: 'pass',
                    message: `å­˜åœ¨ ${totalInternalLinks} ä¸ªå†…éƒ¨é“¾æ¥`,
                    icon: 'ğŸ”„'
                });
            } else if (totalInternalLinks > 0) {
                results.push({
                    name: 'å†…éƒ¨é“¾æ¥',
                    status: 'warn',
                    message: `ä»… ${totalInternalLinks} ä¸ªå†…éƒ¨é“¾æ¥ï¼ˆå»ºè®®å¢åŠ ï¼‰`,
                    icon: 'ğŸ”„'
                });
            } else {
                results.push({
                    name: 'å†…éƒ¨é“¾æ¥',
                    status: 'fail',
                    message: 'æœªæ£€æµ‹åˆ°å†…éƒ¨é“¾æ¥',
                    icon: 'ğŸ”„'
                });
            }

            // 8. å›¾ç‰‡æ£€æµ‹
            const images = doc.querySelectorAll('img');
            const imagesWithAlt = doc.querySelectorAll('img[alt]:not([alt=""])');
            totalChecks++;
            if (images.length > 0 && imagesWithAlt.length === images.length) {
                passCount++;
                results.push({
                    name: 'å›¾ç‰‡ä¼˜åŒ–',
                    status: 'pass',
                    message: `${images.length} å¼ å›¾ç‰‡å…¨éƒ¨æœ‰ alt å±æ€§`,
                    icon: 'ğŸ–¼ï¸'
                });
            } else if (images.length > 0) {
                const missingAlt = images.length - imagesWithAlt.length;
                results.push({
                    name: 'å›¾ç‰‡ä¼˜åŒ–',
                    status: 'warn',
                    message: `${missingAlt}/${images.length} å¼ å›¾ç‰‡ç¼ºå°‘ alt å±æ€§`,
                    icon: 'ğŸ–¼ï¸'
                });
            } else {
                results.push({
                    name: 'å›¾ç‰‡ä¼˜åŒ–',
                    status: 'warn',
                    message: 'é¡µé¢æ²¡æœ‰å›¾ç‰‡',
                    icon: 'ğŸ–¼ï¸'
                });
            }

            // å…³é”®è¯åˆ†æï¼ˆå¦‚æœæä¾›äº†å…³é”®è¯ï¼‰
            if (keyword) {
                const keywordLower = keyword.toLowerCase();

                // 9. å…³é”®è¯åœ¨æ ‡é¢˜ä¸­
                totalChecks++;
                if (title.toLowerCase().includes(keywordLower)) {
                    passCount++;
                    results.push({
                        name: 'å…³é”®è¯ - æ ‡é¢˜',
                        status: 'pass',
                        message: `å…³é”®è¯ "${keyword}" å‡ºç°åœ¨æ ‡é¢˜ä¸­`,
                        icon: 'ğŸ¯'
                    });
                } else {
                    results.push({
                        name: 'å…³é”®è¯ - æ ‡é¢˜',
                        status: 'fail',
                        message: `å…³é”®è¯ "${keyword}" æœªå‡ºç°åœ¨æ ‡é¢˜ä¸­`,
                        icon: 'ğŸ¯'
                    });
                }

                // 10. å…³é”®è¯åœ¨ H1 ä¸­
                const h1Text = h1Tags.length > 0 ? h1Tags[0].textContent.toLowerCase() : '';
                totalChecks++;
                if (h1Text.includes(keywordLower)) {
                    passCount++;
                    results.push({
                        name: 'å…³é”®è¯ - H1',
                        status: 'pass',
                        message: `å…³é”®è¯å‡ºç°åœ¨ H1 æ ‡ç­¾ä¸­`,
                        icon: 'ğŸ¯'
                    });
                } else {
                    results.push({
                        name: 'å…³é”®è¯ - H1',
                        status: 'fail',
                        message: `å…³é”®è¯æœªå‡ºç°åœ¨ H1 æ ‡ç­¾ä¸­`,
                        icon: 'ğŸ¯'
                    });
                }

                // 11. å…³é”®è¯åœ¨æè¿°ä¸­
                totalChecks++;
                if (metaDesc.toLowerCase().includes(keywordLower)) {
                    passCount++;
                    results.push({
                        name: 'å…³é”®è¯ - æè¿°',
                        status: 'pass',
                        message: `å…³é”®è¯å‡ºç°åœ¨å…ƒæè¿°ä¸­`,
                        icon: 'ğŸ¯'
                    });
                } else {
                    results.push({
                        name: 'å…³é”®è¯ - æè¿°',
                        status: 'fail',
                        message: `å…³é”®è¯æœªå‡ºç°åœ¨å…ƒæè¿°ä¸­`,
                        icon: 'ğŸ¯'
                    });
                }

                // 12. å…³é”®è¯å¯†åº¦
                const contentLower = bodyText.toLowerCase();
                const keywordCount = (contentLower.match(new RegExp(keywordLower, 'g')) || []).length;
                const density = charCount > 0 ? ((keywordCount * keyword.length) / charCount * 100).toFixed(2) : 0;
                totalChecks++;
                if (density >= 0.5 && density <= 3) {
                    passCount++;
                    results.push({
                        name: 'å…³é”®è¯å¯†åº¦',
                        status: 'pass',
                        message: `å¯†åº¦ ${density}%ï¼ˆå‡ºç° ${keywordCount} æ¬¡ï¼Œæ¨è 0.5%-3%ï¼‰`,
                        icon: 'ğŸ“ˆ'
                    });
                } else if (keywordCount > 0) {
                    results.push({
                        name: 'å…³é”®è¯å¯†åº¦',
                        status: 'warn',
                        message: `å¯†åº¦ ${density}%ï¼ˆå‡ºç° ${keywordCount} æ¬¡ï¼Œæ¨è 0.5%-3%ï¼‰`,
                        icon: 'ğŸ“ˆ'
                    });
                } else {
                    results.push({
                        name: 'å…³é”®è¯å¯†åº¦',
                        status: 'fail',
                        message: `å…³é”®è¯æœªåœ¨å†…å®¹ä¸­å‡ºç°`,
                        icon: 'ğŸ“ˆ'
                    });
                }
            }

            // è®¡ç®—å¾—åˆ†
            const score = totalChecks > 0 ? Math.round((passCount / totalChecks) * 100) : 0;

            return {
                score,
                passCount,
                totalChecks,
                results,
                url,
                title,
                metaDesc,
                ogTitle,
                ogDesc,
                ogImage
            };
        }

        // æ˜¾ç¤ºç»“æœ
        function displayResults(data) {
            setLoading(false);
            document.getElementById('resultArea').classList.remove('hidden');

            // æ›´æ–°è¯„åˆ†
            const scoreRing = document.getElementById('scoreRing');
            const scoreValue = document.getElementById('scoreValue');
            const scoreLabel = document.getElementById('scoreLabel');
            const scoreDesc = document.getElementById('scoreDesc');

            scoreRing.style.setProperty('--score-percent', data.score + '%');
            scoreValue.textContent = data.score;

            // è®¾ç½®è¯„åˆ†é¢œè‰²
            if (data.score >= 80) {
                scoreRing.style.background = `conic-gradient(#22c55e ${data.score}%, rgba(255,255,255,0.1) ${data.score}%)`;
                scoreLabel.textContent = 'ä¼˜ç§€ ğŸ‰';
                scoreLabel.className = 'text-2xl font-bold mb-2 text-green-400';
            } else if (data.score >= 60) {
                scoreRing.style.background = `conic-gradient(#f59e0b ${data.score}%, rgba(255,255,255,0.1) ${data.score}%)`;
                scoreLabel.textContent = 'è‰¯å¥½ ğŸ‘';
                scoreLabel.className = 'text-2xl font-bold mb-2 text-yellow-400';
            } else {
                scoreRing.style.background = `conic-gradient(#ef4444 ${data.score}%, rgba(255,255,255,0.1) ${data.score}%)`;
                scoreLabel.textContent = 'éœ€è¦ä¼˜åŒ– âš ï¸';
                scoreLabel.className = 'text-2xl font-bold mb-2 text-red-400';
            }

            scoreDesc.textContent = `å…±æ£€æµ‹ ${data.totalChecks} é¡¹ï¼Œé€šè¿‡ ${data.passCount} é¡¹`;

            // å¿«é€Ÿç»Ÿè®¡
            const passItems = data.results.filter(r => r.status === 'pass').length;
            const warnItems = data.results.filter(r => r.status === 'warn').length;
            const failItems = data.results.filter(r => r.status === 'fail').length;

            document.getElementById('quickStats').innerHTML = `
                <span class="status-pass px-3 py-1 rounded-full text-sm">âœ“ é€šè¿‡ ${passItems}</span>
                <span class="status-warn px-3 py-1 rounded-full text-sm">âš  è­¦å‘Š ${warnItems}</span>
                <span class="status-fail px-3 py-1 rounded-full text-sm">âœ— é”™è¯¯ ${failItems}</span>
            `;

            // æ˜¾ç¤ºè¯¦ç»†ç»“æœ
            const resultList = document.getElementById('resultList');
            resultList.innerHTML = data.results.map((item, index) => `
                <div class="result-item flex items-start gap-4 p-4 rounded-xl ${item.status === 'pass' ? 'bg-green-500/10 border border-green-500/20' :
                    item.status === 'warn' ? 'bg-yellow-500/10 border border-yellow-500/20' :
                        'bg-red-500/10 border border-red-500/20'
                }" style="animation-delay: ${index * 50}ms">
                    <span class="text-2xl">${item.icon}</span>
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-1">
                            <h4 class="font-semibold text-white">${item.name}</h4>
                            <span class="${item.status === 'pass' ? 'status-pass' :
                    item.status === 'warn' ? 'status-warn' :
                        'status-fail'
                } px-2 py-0.5 rounded text-xs font-medium">
                                ${item.status === 'pass' ? 'âœ“ é€šè¿‡' : item.status === 'warn' ? 'âš  è­¦å‘Š' : 'âœ— é”™è¯¯'}
                            </span>
                        </div>
                        <p class="text-slate-400 text-sm">${item.message}</p>
                        ${item.detail ? `<p class="text-slate-500 text-xs mt-1 truncate">${item.detail}</p>` : ''}
                    </div>
                </div>
            `).join('');

            // ç”Ÿæˆä¼˜åŒ–å»ºè®®ä»£ç 
            generateSuggestions(data);
        }

        // ç”Ÿæˆä¼˜åŒ–å»ºè®®ä»£ç 
        function generateSuggestions(data) {
            let suggestions = [];

            if (!data.title || data.title.length < 30) {
                suggestions.push(`<title>æ‚¨çš„é¡µé¢æ ‡é¢˜ - å“ç‰Œåç§°</title>`);
            }

            if (!data.metaDesc) {
                suggestions.push(`<meta name="description" content="åœ¨è¿™é‡Œå¡«å†™ 50-160 å­—ç¬¦çš„é¡µé¢æè¿°ï¼ŒåŒ…å«æ ¸å¿ƒå…³é”®è¯ã€‚">`);
            }

            if (!data.ogTitle) {
                suggestions.push(`<meta property="og:title" content="${data.title || 'é¡µé¢æ ‡é¢˜'}">`);
            }

            if (!data.ogDesc) {
                suggestions.push(`<meta property="og:description" content="${data.metaDesc || 'é¡µé¢æè¿°'}">`);
            }

            if (!data.ogImage) {
                suggestions.push(`<meta property="og:image" content="https://example.com/og-image.png">`);
            }

            const suggestionSection = document.getElementById('suggestionSection');
            const suggestionCode = document.getElementById('suggestionCode');

            if (suggestions.length > 0) {
                suggestionSection.classList.remove('hidden');
                suggestionCode.textContent = suggestions.join('\n');
            } else {
                suggestionSection.classList.add('hidden');
            }
        }

        // å¤åˆ¶ä»£ç 
        function copyCode() {
            const code = document.getElementById('suggestionCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showToast('ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            }).catch(() => {
                showToast('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
            });
        }

        // æ¸…é™¤ç»“æœ
        function clearResults() {
            document.getElementById('resultArea').classList.add('hidden');
            document.getElementById('urlInput').value = '';
            document.getElementById('keywordInput').value = '';
        }

        // è®¾ç½®åŠ è½½çŠ¶æ€
        function setLoading(loading) {
            const btn = document.getElementById('auditBtn');
            const btnText = document.getElementById('btnText');
            const btnIcon = document.getElementById('btnIcon');
            const loadingState = document.getElementById('loadingState');

            if (loading) {
                btn.disabled = true;
                btn.classList.add('opacity-50', 'cursor-not-allowed');
                btnText.textContent = 'åˆ†æä¸­...';
                btnIcon.textContent = 'â³';
                loadingState.classList.remove('hidden');
                document.getElementById('resultArea').classList.add('hidden');
            } else {
                btn.disabled = false;
                btn.classList.remove('opacity-50', 'cursor-not-allowed');
                btnText.textContent = 'å¼€å§‹åˆ†æ';
                btnIcon.textContent = 'ğŸš€';
                loadingState.classList.add('hidden');
            }
        }

        // æ›´æ–°åŠ è½½æç¤º
        function updateLoadingTip(tip) {
            document.getElementById('loadingTip').textContent = tip;
        }

        // Toast æç¤º
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${type === 'success' ? 'bg-green-600' :
                type === 'error' ? 'bg-red-600' :
                    'bg-purple-600'
                } text-white font-medium animate-pulse`;
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // å›è½¦è§¦å‘åˆ†æ
        document.getElementById('urlInput').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                runAudit();
            }
        });
    </script>
</body>

</html>